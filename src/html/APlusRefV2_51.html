<HTML>
<HEAD>
<TITLE>A+ Reference: Invoking A+</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<A NAME=HEADING600>
<H1><FONT color="#FF0000"><A NAME=0>Invoking A+</FONT></H1>
<a name="CONTENTS50">
<UL>
<A HREF="#HEADING601">  Invocation From the Shell Environment</A><BR>
<UL>
<A HREF="#2">  From Within an Emacs Session</A><BR>
<A HREF="#6">  From a Shell Command Line</A><BR>

<!----
<A HREF="#8A"> Workstations With AFS Installed</A><BR>
//---->

</UL>
</UL>
<HR>
<A NAME=HEADING601>
<H1><FONT color="#20B2AA">Invocation <A NAME=1>From the Shell; Environment</FONT></H1>

<H2><FONT color="#20B2AA">&nbsp;&nbsp;&nbsp;From Within an <A NAME=2>Emacs Session</FONT></H2>
<blockquote>
<A NAME=4>If you start an Emacs session by selecting <b>Emacs/A+</b> from the main menu, A+
 can be invoked within it (with the resulting buffer in a-mode) by
 pressing the function key <b>F4</b>. When in Emacs, you can modify the effect of the
 <b>F4</b> key by entering <b>Control-c&nbsp;a</b>.
</blockquote>
<A NAME=5><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Concurrent Sessions</b>
<blockquote>
You can run several Emacs A+ sessions concurrently. You can run A+ in several concurrent
 Emacs sessions. Moreover, to run concurrent A+ sessions within a single Emacs session,
 after starting one A+ session, you can rename it by pressing  <b>Escape&nbsp;x</b> and
 entering <font face=Courier>
 M-x&nbsp;<b>rename-buffer</b>&nbsp;<i>newname</i></font>,&nbsp;
 then perhaps change to another release using<b> Control-c&nbsp;a</b>, then start another
 session by pressing <b>F4</b>, then perhaps rename that session and start another one,
 and so on.
</blockquote>

<!----
<A NAME=5A><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XEmacs</b>
<blockquote>
You can invoke XEmacs using<br>
<font face=Courier>xemacs</font><br>
(you may need to do a<font face=Courier> module&nbsp;load&nbsp;fsf/xemacs/19.13
</font>first) and start an A+ session in it using the menu bar. The A+ keyboard is
 automatically enabled by starting an A+ session, editing an A+ script, pressing the
 <b>Props</b> key, or  selecting <b>Toggle A+ Keyboard</b> from the <b>A+</b> submenu.
</blockquote>
//---->

<H2><FONT color="#20B2AA"><A NAME=6>&nbsp;&nbsp;&nbsp;From a Shell Command Line</FONT></H2>
<blockquote>
A+ can also be invoked from a shell command line, by
<font face=Courier><b>a+</b>&nbsp;<i>[options]&nbsp;[script&nbsp;[args]]</i></font>,&nbsp;
 where the meaning of the parameters is as follows.
<UL>
<LI><i>options:</i><font face=Courier><br>
&nbsp;&nbsp;&nbsp;<b>-d</b> <i>display</i></font><br>
Set the environment variable DISPLAY to <font face=Courier><i>display</i></font>.<br>
<font face=Courier>&nbsp;&nbsp;&nbsp;<b>-h</b></font><br>
Set the heap size to 128 megabytes. CAUTION: Do <i>not</i> use this flag unless it
 specifically solves a memory related problem.<br>
<font face=Courier>&nbsp;&nbsp;&nbsp;<b>-m</b> <i>memmap<br>
memmap</i></font> is one of the memory mapping methods for atmp described in the
 "<a href='APlusRefV2_14.html#210B'>Work Area</a>" section (Releases 2.42 and 4.09 on).<br>
<font face=Courier>&nbsp;&nbsp;&nbsp;<b>-q</b></font><br>
Suppress the banner (Releases 2.42 and 4.09 on).<br>
<font face=Courier>&nbsp;&nbsp;&nbsp;<b>-w</b> <i>wssize</i></font><br>
Set the initial workspace size to <font face=Courier><i>wssize</i></font>
 (in megabytes).<br><P>
<LI><i>script:</i><BR>
The name of the script to be loaded when A+ is invoked.<P>
<LI><A NAME=7><i>args:</i><BR>
The parameter list for the script, which is made available to the script by the special
 system variable<font face=Kapl> _argv</font>.<BR>
The value of <font face=Kapl>_argv</font> is a vector of character strings.<BR>
Following the Unix and C language conventions,<BR>
<font face=Kapl>&nbsp;&nbsp;&nbsp;0Ø_argv </font>is the name of the script,<BR>
<font face=Kapl>&nbsp;&nbsp;&nbsp;1Ø_argv </font>is the first parameter,<BR>
<font face=Kapl>&nbsp;&nbsp;&nbsp;2Ø_argv </font>is the second, etc.
</UL>
The <A NAME=8>PWD (environment name) environment variable is set on startup.<P>
<A NAME=8B>If you want to suppress all error reports (messages to stderr) for the session,
 you can put<font face=Courier> <b>2&gt;/dev/null</b> </font>at the end of the shell
 command line.<p>
<!----
For saving the screen configuration for future restarting, see
 <A HREF="example_wmsave.html#0">example</A>.
//---->
</blockquote>


<!----
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Examples</b>
<blockquote>
<font face=Courier>a+</font><br>
<A NAME=9>Invoke A+ using all of the defaults (the default workspace size is 1 MB, or
 2<sup>20</sup> bytes.)</p>
<font face=Courier>a+&nbsp;-w&nbsp;100</font><br>
Invoke A+ with a 100MB virtual workspace.</p>
<font face=Courier>a+&nbsp;-d&nbsp;workstation-name:0.0&nbsp;graphit&nbsp;expertlevel</font><br>
Invoke A+ with the environment variable DISPLAY set to<font face=Courier>
 workstation-name:0.0</font>, and load the script named<font face=Courier>
 graphit </font>with the parameter<font face=Courier> expertlevel</font>. The
 value of<font face=Kapl> _argv </font> in the A+ session will be<font face=Kapl>
 ("graphit";"expertlevel")</font>.</P>
<A NAME="11">A+ uses the search rules described for <font face=Kapl>$load</font> to find the
 application script<font face=Courier> graphit</font>. The rules are based on the
 environment variable APATH. If APATH is not set by the user, it is set to its default value
 when A+ is invoked. The default setting of APATH through Releases 2.45 and 4.05 is:<P>
<font face=Courier><A NAME="12">.:$ATREE/lib</font><P>
from Releases 4.06 through 4.09 it is:<p>
<font face=Courier>.:$ATREE/lib</font><P>
for Release 2.46 it is:<p>
<font face=Courier>.:a:<br>
</font><P>
and for Release 4.1003 it is:<p>
<font face=Courier>.:a</font><P>
Like APATH, if the environment variable ATREE is not set by the user, it is set to its
 default value when A+ is invoked, as follows. An attempt is made to set it from
 <font face=Kapl>_argv[0]</font>:<BR>
First, if it isn't qualified (doesn't contain a "<font face=Courier>/</font>"),
the directories in $PATH are searched to try to construct a qualified name.
Then if <font face=Kapl>_argv[0]</font> (or
 the name constructed from it) is of the form<font face=Courier> <i>path</i>/bin/...
 </font>and<font face=Courier> <i>path</i>/lib/s.+ </font>is loadable, ATREE is set
 to<font face=Courier> <i>path</i></font>.<BR>
<P>
When an A+ process initiates a second A+ process, the second process inherits the value of
 ATREE and APATH from the first, even if the process is detached. To avoid this, do,
 e.g.,<br>
<font face=Kapl>&nbsp;&nbsp;&nbsp;&nbsp;sys.system{"unset&nbsp;ATREE;/usr/local/bin/a+"}</font><br>
or<br>
<font face=Kapl>&nbsp;&nbsp;&nbsp;&nbsp;$(unset&nbsp;ATREE;/usr/local/bin/a+)</font><br>
and also unset APATH.<p>
The aim is for ATREE to always point to the release of A+ in use. An example of its use is
 to ensure that the correct version of the screen management system is loaded, as
 follows:<br>
<font face=Kapl>&nbsp;&nbsp;&nbsp;&nbsp;_load&nbsp;(sys.readenv&nbsp;"ATREE"),"/lib/s"</font></p>
</blockquote>
//---->


<! ----------------------------------------------------------------------------------->


<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Examples</b>
<blockquote>
<font face=Courier>/usr/local/bin/a+</font><br>
<blockquote>
Invoke A+ using all of the defaults
 (the default workspace size is 1 MB, or 2<sup>20</sup> bytes.)
</blockquote>

<font face=Courier>/usr/local/bin/a+ -w 100</font><br>
<blockquote>
Invoke A+ with a 100MB virtual workspace.
</blockquote>


<font face=Courier>/usr/local/bin/a+ -d workstation-name:0.0 graphit expertlevel</font>
<blockquote>
Invoke A+ with the environment variable DISPLAY
 set to <i>workstation-name:0.0</i>, and load the script
 named graphit with the parameter expertlevel.
 The value of <font face=Courier>_argv</font> in the A+ session will be
 <font face=Courier>("graphit";"expertlevel")</font>.
</blockquote>
<p>
<A NAME="15">
A+ uses the search rules described for <font face=Courier>$load</font>
 to find the application script <i>graphit</i>.
 The rules are based on the environment variable APATH.
 The default setting of APATH is:
<p>
<font face=Courier>.:/usr/local/aplus-fsf-n.nn/lib</font>
<p>
APATH is automatically set by A+ on startup
 and its value is derived from another automatically set A+ environment variable,
 ATREE.
 If either if these environment variables exist prior to starting A+ the existing
values are used.
<p>
It is very important for these variables to be set correctly
 and it is recommended that A+ set them.
 If set incorrectly, the wrong versions of s and adap will be loaded.
<p>
If customization of APATH is required,
 it is recommended that it is done after A+ has started:
<blockquote>
<font face=Courier>sys.setenv{"APATH=/look/here/first:",sys.readenv "APATH"}</font><br>
</blockquote>
Correct commands:
<blockquote>
<font face=Courier>sys.system{"unset APATH ATREE;/usr/local/bin/a+"}<br>
$(unset APATH ATREE;/usr/local/bin/a+)</font><br>
</blockquote>
Note: When an A+ process initiates a second A+ process,
 the second process inherits the value of ATREE and APATH from the first,
 even if the process is detached. To avoid this, do, e.g.,
<blockquote>
<font face=Courier>sys.system{"unset ATREE APATH;/usr/local/bin/a+"}</font><br>
</blockquote>
or
<blockquote>
<font face=Courier>$(unset ATREE APATH;/usr/local/bin/a+)</font><br>
</blockquote>

<! ----------------------------------------------------------------------------------->

</blockquote>
<HR>
<ADDRESS><table width="100%"><tr><td><font size=2><i><a href="mailto:doc@aplusdev.org">doc@aplusdev.org</a></i></font></td><td align=right><font size=2><i>&#169; Copyright 1995&#150;2008 Morgan Stanley Dean Witter &amp; Co.  All rights reserved.</i></font></td></tr></table></ADDRESS>
</BODY>
</HTML>
