ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.
$cx gyr

state{cx;sh}:(>Ø¡1Ø¡cx%¡cx%`_GYR)É@1Û1 Ý (r;c)ûsh

set_state{s;d;i;p;c;v}:
	{
	(i;j)û,¡2Ùi;
	if (()½i) iûÉ#c%v;
	if (()½j) jûÉ1#Òc%v;
	dû((#i),#j)Òd;
	(iiû#i) do (jjû#j) do ((((ii;jj)#d)#c%`_LIGHTS)Øc%Â'_LIGHT_',(1Õîii#i),'_',1Õîjj#j)û1;
	}

traffic_system{cx;sh}:
	{
	(r;c)ûsh;
	rcû!(Ér),@0 0 0 ÛÉc;
	rsû1Õ¡î¡rc[;0];
	csû1Õ¡î¡rc[;1];
	nsûshÒ>Â¡namesû(<'_LIGHT_'),¡rs,¡'_',¡cs;
	(iûr) do (jûc) do
		{
		nû(i;j)#ns;
		(cx%n)û(cx%`_LIGHTS;(1;0;0));
		(cx,n) .has (`.labelfont;cxÖ`_FONT;`.geometry;cxÖ`_GEOMETRY;`class;`radio;`title;'';`hl;`black;`fg;cx%`_COLORS;`bg;`black;`label;```;`resize;'hHwW');
		};
	cxâ'_STATE:gyr.state{`',(Îcx),';_SHAPE}',Ø'Ý',¡names;
	(cx,`_STATE) _scb (set_state;);
	ns
	}

define{cx}:
	{
	WSûs.autows{()};
	(cx%`_SHAPE)û0 0;
	(cx%`_FONT)û'courier-10';
	(cx%`_GEOMETRY)û`vertical;
	(cx%`_LIGHTS)û`r`y`g;
	(cx%`_COLORS)û`red`gold`green;
	cxâ'_GYR:gyr.traffic_system{`',(Îcx),';_SHAPE}';
	(cx,`_GYR) .has (`class;`layout;`title;'';`newshow;1;`reparent;0;`bg;`black);
	s.autows{WS};
	cxÖ`_GYR
	}
