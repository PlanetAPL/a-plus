ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.

$cx doc

select{s;c;v}:if (0¤rû0Ø`row .of c,v) (c%`_GADGET)û'/ms/dist/apluslib/PROJ/s/1.0/common/',p Ý pû(p¨' ')/p Ý pûr#c%v
view{x}:if (()½x) '' else untab{read{x,'.doc'};8}

untab{x;y}:
	{
  	tabû`char©9;
  	nlû`char©10;
  	delsû(¢1÷xÅtab,nl)/É#x;		ã delimiters (reset the count here)
  	ldû((dels,#x)-0,dels)/0,dels;	ã last delimiter seen
  	nsû1+y|¢1+ld-É#x;		ã number of spaces (if this is a tab)
  	((tabsûx=tab)/x)û' ';		ã turn tabs to spaces
 	(1+tabs«ns-1)/x			ã and add the extra spaces
	}

read{file}:
	{
	if (0>sûsys.filesize{file}) ÙÂ'read failed: (',(îs),') ',file;
    	aûsÒ`char©0;
    	fdûsys.open{file;0;0};
    	sys.read{fd;a;s};
    	sys.close{fd};
	a
	}

define{cx}:
	{
	WSûs.autows{()};

	aûsys.agetdents{'/ms/dist/apluslib/PROJ/s/1.0/common/'};
	bû0<>#¡_ss¡{<@1 a;<'.doc'};
	(cx%`_GADGETS)û3Ù@1(èa)#aûb/a;
	(cx%`_GADGET)û();
	cxâ'_VIEW:doc.view{_GADGET}';
	(cx%`_DOC)û`_GADGETS `_VIEW;

	(cx,`_GADGETS) .is `view;
	(cx,`_VIEW) .is `text;
	(cx,`_DOC) .is `vpane;

	(cx,`_GADGETS) .has (`title;'Gadgets';`select;select);
	(cx,`_VIEW) .has (`title;'Doc';`protect;1);
	(cx,`_DOC) .has (`title;'/ms/dist/apluslib/PROJ/s/1.0/common/');
	
	s.autows{WS};

	cxÖ`_DOC
	}


