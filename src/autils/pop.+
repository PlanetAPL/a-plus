ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.

$cx pop

OPTIONSû(`left `right `top `bottom;(`center `left;`center `right;`top `center;`bottom `center))
		
popup{s;d;i;p;c;v}:if (~d½1) popdown{s;c;v} else (c,`_POP) .has `raise Ý .show c,`_POP Ý locate{c} Ý natural{c} Ý sensitive{c;0}
popdown{s;c;v}:(c,`_GO) _scb (popup;) Ý (c%`_GO)û0 Ý (c,`_GO) _scb (;) Ý if (0=0Ø`show .of c,`_POP Ý .hide c,`_POP) sensitive{c;1}

locate{c}:if (0<#l Ý lûc%`_LOCATE) if (0=0Ø`show .of c,`_POP) position{c;Ø`YX `yxs .of l;0Ø`yxs .of c,`_POP}
options{x}:if (2=#x) (x[0]Å`left `right)÷x else if (()½x) `center `center else xØOPTIONS
natural{c}:if (c%`_SIZE) (c,`_POP) .has `naturalsize
sensitive{c;x}:if (0<#w Ý wûc%`_SHELLS) w .has¡<(`sensitive;x)

position{c;a;b}:
	{
	(v;h)ûoptions{c%`_POSITION};
	yûcase (v) {`center;0ÓÄa[0]+.5«a[2]-b[0];`top;0Óa[0]-b[0];`bottom;+/a[0 2]};
	xûcase (h) {`center;0ÓÄa[1]+.5«a[3]-b[1];`left;0Óa[1]-b[1];`right;+/a[1 3]};
	(c,`_POP) .has (`yx;y,x);
	}

define{cx}:
	{
	WSûs.autows{()};

	(cx%`_SIZE)û1;
	(cx%`_SHELLS)û();
	(cx%`_LOCATE)û();
	(cx%`_POSITION)û();

	(cx%`_GO)û0;
	(cx,`_GO) _scb (popup;);

	(cx%`_POP)û();
	(cx,`_POP) .is `layout;
	(cx,`_POP) .has (`title;'';`realize;1;`newshow;1;`reshow;0;`exit;popdown);
	
	s.autows{WS};

	cxÖ`_POP
	}
	   
