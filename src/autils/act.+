ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.

$cx act
		
popup{s;d;i;p;c;v}:(c,`_ACT) .has `raise Ý .show c,`_ACT Ý locate{c} Ý natural{c} Ý sensitive{c;0} Ý hide_msg{c;v;d}
hide_msg{c;v;d}:(c,v) .has (`hide;0=#d)
popdown{s;c;v}:(c%`_Z)ûs Ý if (0=0Ø`show .of c,`_ACT Ý .hide c,`_ACT) sensitive{c;1}

locate{c}:if (0<#l Ý lûc%`_LOCATE) if (0=0Ø`show .of c,`_ACT) (c,`_ACT) .has (`yx;0ÓÄ(0Ø`YX .of l)+.5«(0Ø`yxs .of l)-0Ø`yxs .of c,`_ACT)
natural{c}:if (c%`_SIZE) (c,`_ACT) .has `naturalsize

sensitive{c;x}:if (0<#w Ý wûc%`_SHELLS) w .has¡<(`sensitive;x)
newlines{s;d;i;p;c;v}:if (~nlÅd Ý nlû"\n") d else >(Ó/>#¡z)Ù¡z Ý zû1Õ¡(Úd=nl)Údû((nl¨1Ùd)/nl),d

define{cx}:
	{
	WSûs.autows{()};

	(cx%`_FONT)û'kaplscreen-bold';

	(cx%`_Z)û();
	(cx%`_SIZE)û1;
	(cx%`_SHELLS)û();

	(cx%`_MSG)û'';
	(cx%`_STUFF)û();
	(cx%`_LOCATE)û();
	(cx%`_APPLY)û(popdown;`apply);
	(cx%`_CANCEL)û(popdown;`cancel);
	(cx%`_ACT)û(`_MSG;`_STUFF;`_APPLY `_CANCEL);

	(cx,`_MSG) .is `label;
	(cx,`_STUFF) .is `layout;
	(cx,`_APPLY) .is `button;
	(cx,`_CANCEL) .is `button;
	(cx,`_ACT) .is `layout;

	fûcxÖ`_FONT;

	(cx,`_APPLY) s.uses (`font;f;`titlefont;f);
	(cx,`_CANCEL) s.uses (`font;f;`titlefont;f);
	(cx,`_MSG) s.uses (`font;f);

	(cx,`_APPLY) .has (`title;'Apply';`acceptfocus;0;`dynamic;1);
	(cx,`_CANCEL) .has (`title;'Cancel';`acceptfocus;0;`dynamic;1);
	(cx,`_STUFF) .has (`title;'';`newshow;1;`reshow;0);
	(cx,`_MSG) .has (`preset;newlines;`set;popup);
	(cx,`_ACT) .has (`C;1;`title;'';`exit;0;`realize;1);
	
	s.autows{WS};

	cxÖ`_ACT
	}
	   
