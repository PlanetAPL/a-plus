ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.
$cx cbr

out_sym{s;d;i;p;c;v}:if (`sym¨©d) '' else Îd
sym_sort{x}:(èx)#x

att_select{s;c;v}:(c%evar)ûif (0>rû0Ø`row .of c,v Ý (cls;evar)ûs) ' ' else attribute_of{r#c%v}
attribute_of{a}:(Îa),': ',if (aÅ0Øs.ATTRIBUTE_DESC) aØs.ATTRIBUTE_DESC else ''
cls_refer{s;c;v}:if (rÅi Ý (r;i;p)ûrow_index{c;v}) show_window{c;v;p} else hide_window{c;v;p}
hide_window{c;v;p}:w .has (`show;0) Ý wûcÖÂ'_LAY_',Îp Ý global_index{c;v;p;0}
show_window{c;v;p}:w .has (`show;1;`raise;1) Ý wûdefine_class{c;p} Ý global_index{c;v;p;1}
row_index{c;v}:(r;i;p) Ý pûr#c%v Ý (r;i)û`row`index .of c,v Ý s.call{c,v;`refer}
global_index{c;v;p;b}:if (b) (c%`_CLASSES)[,]ûp else (c%`_CLASSES)û(k¨p)/k Ý kûc%`_CLASSES

define_class{cx;cls}:
	{
	lvarûÂ'_LAY_',Îcls;
	if (~0Ø`bound .of cx,lvar)
		{
		WSûs.autows{()};
		dvarûÂ'_DESC_',Îcls;
		evarûÂ'_ADSC_',Îcls;
		avarûÂ'_ATTS_',Îcls;
		svarûÂ'_SUPC_',Îcls;
		ivarûÂ'_INDX_',Îcls;
		descû(Îcls),': ',clsØs.CLASS_DESC;
		eescû' ';
		attsûsym_sort{s.primitiveTo{cls}};
		sclsûsym_sort{s.proper_flat_super{cls}};
		(cx%dvar)ûdesc;
		(cx%evar)ûeesc;
		(cx%avar)ûatts;
		(cx%svar)ûscls;
		cxâ(Îivar),':(',(Îsvar),'Å_CLASSES)/É#',Îsvar;
		(cx%lvar)û(dvar;evar;avar,svar);
		(cx,ivar) .has (`class;`object);
		(cx,dvar) .has (`class;`label;`justify;'l');
		(cx,evar) .has (`class;`label;`justify;'l');
		(cx,avar) .has (`class;`array;`space;10Ó1#ÒÎatts;`title;'Attributes';`out;out_sym;`rowsep;0;`colsep;0;`select;(att_select;cls,evar);`protect;1);
		(cx,svar) .has (`class;`array;`space;10Ó1#ÒÎscls;`title;'Classes';`out;out_sym;`rowsep;0;`colsep;0;`refer;cls_refer;`protect;1;`.index;cxÖivar);
		(cx,lvar) .has (`class;`layout;`title;'');
		s.autows{WS};
		};
	cxÖlvar
	}

define{cx}:
	{
	WSûs.autows{()};
	(cx%`_CLASSES)û();
	(cx%`_CBR)ûclssûsym_sort{s.realClasses{}};
	(cx,`_CBR) .has (`class;`array;`refer;cls_refer;`space;10Ó1#ÒÎclss;`protect;1;`title;'Real Classes';`rowsep;0;`colsep;0;`out;out_sym);

	s.autows{WS};

	cxÖ`_CBR
	}
