ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.

$cx tbr

if( ()½scriptsDirûsys.readenv{"UTILS_DIR"} ) {
  scriptsDirû"/usr/local/aplus-fsf-4.22/autils";
}

_load{scriptsDir,"/ted"}
_load{scriptsDir,"/tss"}
_load{scriptsDir,"/dlu"}
_load{scriptsDir,"/flu"}


define{cx}:
	{
	tssxûÂ(Îcx),'_tss';
	Ý tss.define{tssx};

	tedxûÂ(Îcx),'_ted';
	Ý ted.define{tedx};

	dluxûÂ(Îcx),'_dlu';
	Ý dlu.define{dlux};
   	(dlux%`_FILTERS)û(`m;<1);

	fluxûÂ(Îcx),'_flu';
	Ý flu.define{flux};
   	(flux%`_FILTERS)û(`m;<1);

	(cx%`_TSS)ûtssx;
	(cx%`_TED)ûtedx;
	(cx%`_DLU)ûdlux;
	(cx%`_FLU)ûflux;

	(cx%`_MODE)û`flu;

	WSûs.autows{()};

	(cx%`_ACTION)û(`Browse `Describe;(;));
	cxâ'_TBR:tbr.mode{_MODE;`',(Îdlux),'._DLU`',(Îflux),'._FLU},`_ACTION';

	(cx,`_ACTION) .is `action;
	(cx,`_TBR) .is `layout;

	(cx,`_ACTION) .has (`title;'';`geometry;`horizontal;`set;set_action;`acceptfocus;0;`C;1);
	(cx,`_TBR) .has (`title;'';`newshow;1;`reshow;0;`reparent;1);

	s.autows{WS};

	cxÖ`_TBR
	}

mode{m;v}:(`dlu `fluÉm)#v
dir{c;m}:(`dlu `fluÉm)#(c%`_DLU),c%`_FLU

describe{c}:activate{c;`_TED;`Load}
browse{c}:activate{c;`_TSS;`Open}

activate{c;x;y}:
	{
	dûdir{c;c%`_MODE}%`_DIR;
	cxûc%x;
	(cx%`_DIR)ûd;
	(cx%`_DO)ûy;
	(cx,x) .has (`show;1;`raise;1);
	}

set_action{s;d;i;p;c;v}:
	{
	case (p)
		{	
		`Browse;	browse{c};
		`Describe;	describe{c}
		};
	}
