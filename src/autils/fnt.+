ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.
$cx fnt

$wa 5

group_part{f;r}:(Úb¨¢1Õ¢1,bûj#k)ÚjûèkûkÉkûô>if (r½() Ý (f;r)û,¡(f;r)) fÉ¡f else rè¡f

tokenize{x}:(#FIELDS)Ù(1Õ¡(Úx='-')Úx),(#FIELDS)Ò<''

font_names{}:
	{
	pidû1Õîsys.getpid{};
	â'$xlsfonts > /tmp/fonts.temp_created_by_S_',pid;
	zûsys.readmat{'/tmp/fonts.temp_created_by_S_',pid};
	â'$rm /tmp/S_fonts.temp_created_by_S_',pid;
	(-Ä/(÷@1' '=z)É@1Û0)Õ@1zû(z[;0]='-')/z
	}

FIELDSû`Foundry `Family `Weight `Slant `Set_width `Style `Pixels `Points `Resolution_X `Resolution_Y `Spacing `Avg_width `Charset `Encoding

FONTSûfont_names{}

font_slot{}:font_part{tokenize¡{<@1 FONTS};FIELDS}

font_part{f;fs}:
	{
	if (0<#fs)
		{
		gû>(Ó/>#¡g)Ù¡gû0Ø¡f;
		jûgroup_part{<g;};
		((Â(Îfs[0]),':'),Â(>0#¡j)#g;(<()),&¡{1Õ¡¡j#¡<f;<1Õfs})
		}
	}

set_self{s;d;i;p;c;v}:(c,v) .has (`font;c%v)

set_font{s;d;i;p;c;v}:(c%`_FONT)ûif ((#p)=#FIELDS) Ø'-',¡Î¡p else (FONTS[;É#f]ÉfûØ'-',¡Î¡¢1Õp)#FONTS

define{cx}:
	{
	WSûs.autows{()};
	
	(cx%`_FONT)û'';
	(cx,`_FONT) .is `label;
	(cx%`_FONT)û0Ø`font .of cx,`_FONT;
	(cx,`_FONT) .has (`set;set_self);

	(cx%`_FNT)ûfont_slot{};
	(cx,`_FNT) .is `vmenu;
	(cx,`_FNT) .has (`set;set_font);

	s.autows{WS};

	cxÖ`_FNT
	}

