ãã Copyright (c) 1990-2008 Morgan Stanley All rights reserved.
ãã See .../src/LICENSE for terms of distribution.

$cx abx
		
popup{s;d;i;p;c;v}:(c,`_ABX) .has `raise Ý .show c,`_ABX Ý locate{c} Ý natural{c} Ý sensitive{c;0} Ý hide_msg{c;v;d}
hide_msg{c;v;d}:(c,v) .has (`hide;0=#d)
popdown{s;c;v}:(c%`_Z)û`ok Ý if (0=0Ø`show .of c,`_ABX Ý .hide c,`_ABX) sensitive{c;1}

locate{c}:if (0<#l Ý lûc%`_LOCATE) if (0=0Ø`show .of c,`_ABX) (c,`_ABX) .has (`yx;0ÓÄ(0Ø`YX .of l)+.5«(0Ø`yxs .of l)-0Ø`yxs .of c,`_ABX)
natural{c}:if (c%`_SIZE) (c,`_ABX) .has `naturalsize

sensitive{c;x}:if (0<#w Ý wûc%`_SHELLS) w .has¡<(`sensitive;x)
newlines{s;d;i;p;c;v}:if (~nlÅd Ý nlû"\n") d else >(Ó/>#¡z)Ù¡z Ý zû1Õ¡(Úd=nl)Údû((nl¨1Ùd)/nl),d

define{cx}:
	{
	WSûs.autows{()};

	(cx%`_FONT)û'kaplscreen-bold';

	(cx%`_Z)û();
	(cx%`_SIZE)û1;
	(cx%`_SHELLS)û();

	(cx%`_MSG)û'';
	(cx%`_STUFF)û();
	(cx%`_LOCATE)û();
	(cx%`_OK)û<{popdown};
	(cx%`_ABX)û(`_MSG;`_STUFF;`_OK);

	(cx,`_MSG) .is `label;
	(cx,`_STUFF) .is `layout;
	(cx,`_OK) .is `button;
	(cx,`_ABX) .is `layout;

	fûcxÖ`_FONT;

	(cx,`_OK) s.uses (`font;f;`titlefont;f);
	(cx,`_MSG) s.uses (`font;f);

	(cx,`_OK) .has (`title;'OK';`acceptfocus;0;`dynamic;1);
	(cx,`_STUFF) .has (`title;'';`newshow;1;`reshow;0);
	(cx,`_MSG) .has (`preset;newlines;`set;popup);
	(cx,`_ABX) .has (`C;1;`title;'';`exit;0;`realize;1);
	
	s.autows{WS};

	cxÖ`_ABX
	}
	   
